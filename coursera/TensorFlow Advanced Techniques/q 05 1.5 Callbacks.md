## 1.5 Callbacks

## Questions

#### 1. Which of the following methods are called at the **start and end of each epoch** during training in a Keras callback?  
A) on_epoch_begin  
B) on_epoch_end  
C) on_train_batch_begin  
D) on_train_batch_end  

#### 2. When creating a custom callback by subclassing `tf.keras.callbacks.Callback`, which method(s) would you override to execute code **before and after processing each training batch**?  
A) on_train_batch_begin  
B) on_train_batch_end  
C) on_epoch_begin  
D) on_predict_batch_end  

#### 3. Which of the following are valid ways to use callbacks in Keras model methods?  
A) model.fit(..., callbacks=[...])  
B) model.evaluate(..., callbacks=[...])  
C) model.predict(..., callbacks=[...])  
D) model.compile(..., callbacks=[...])  

#### 4. The `ModelCheckpoint` callback can be configured to:  
A) Save only the model weights instead of the full model  
B) Save the model only when a monitored metric improves  
C) Automatically stop training when validation loss stops improving  
D) Save the model every batch by default  

#### 5. What is the purpose of the `EarlyStopping` callback?  
A) To save the best model weights during training  
B) To stop training when a monitored metric stops improving  
C) To log training metrics to a CSV file  
D) To prevent overfitting by halting training early  

#### 6. Which parameters of `EarlyStopping` control how sensitive it is to improvements in the monitored metric?  
A) patience  
B) min_delta  
C) baseline  
D) save_best_only  

#### 7. When using the `TensorBoard` callback, which of the following are true?  
A) It can visualize the model graph  
B) It tracks metrics like loss and accuracy during training  
C) It automatically saves model checkpoints  
D) It requires specifying a log directory  

#### 8. Which of the following statements about the `logs` argument passed to callback methods is true?  
A) It contains the current batch number  
B) It contains metrics and loss values relevant to the current step  
C) It is always an empty dictionary  
D) It can be used to access validation metrics during `on_epoch_end`  

#### 9. Which callback method(s) would you override to perform an action **right before training starts** and **right after training ends**?  
A) on_train_begin and on_train_end  
B) on_epoch_begin and on_epoch_end  
C) on_train_batch_begin and on_train_batch_end  
D) on_test_begin and on_test_end  

#### 10. What happens if you set `restore_best_weights=True` in the `EarlyStopping` callback?  
A) The model weights are reset to the best epoch’s weights after training stops  
B) The model saves the best weights to disk automatically  
C) Training will continue indefinitely until manually stopped  
D) The callback will ignore the `patience` parameter  

#### 11. Which of the following are true about saving models with `ModelCheckpoint`?  
A) You can save models in both H5 and SavedModel formats  
B) You can include epoch number and metric values in the filename  
C) It can only save the entire model, not just weights  
D) It can save checkpoints at a specified frequency  

#### 12. In a custom callback, what is the effect of setting `self.model.stop_training = True` inside a callback method?  
A) It immediately stops the training loop after the current batch or epoch  
B) It pauses training until manually resumed  
C) It resets the model weights to initial values  
D) It triggers saving the model checkpoint  

#### 13. Which of the following callback methods are called during **evaluation** (testing) but not during training?  
A) on_test_begin  
B) on_train_batch_end  
C) on_test_batch_end  
D) on_predict_end  

#### 14. What is the main difference between `on_train_batch_end` and `on_epoch_end` callback methods?  
A) `on_train_batch_end` is called after every batch, `on_epoch_end` after every epoch  
B) `on_train_batch_end` is called only once per epoch  
C) `on_epoch_end` is called before training starts  
D) `on_train_batch_end` is called only during evaluation  

#### 15. Which of the following are valid reasons to create a **custom callback**?  
A) To log additional information not covered by built-in callbacks  
B) To stop training based on a custom condition  
C) To visualize intermediate predictions during training  
D) To automatically tune hyperparameters during training  

#### 16. Consider a callback that monitors the ratio of validation loss to training loss and stops training if the ratio exceeds a threshold. Which callback method is best suited to implement this logic?  
A) on_epoch_end  
B) on_train_batch_end  
C) on_train_begin  
D) on_predict_end  

#### 17. When using multiple callbacks in `model.fit()`, which of the following statements are true?  
A) All callbacks receive the same event notifications independently  
B) Callbacks can interfere with each other and cause errors  
C) You can combine callbacks like EarlyStopping, ModelCheckpoint, and TensorBoard together  
D) Only one callback can be active at a time  

#### 18. Which of the following are true about the `CSVLogger` callback?  
A) It saves training metrics to a CSV file after each epoch  
B) It can log both training and validation metrics  
C) It automatically stops training if validation loss increases  
D) It requires manual calls to save the CSV file  

#### 19. What is the role of the `update_freq` parameter in the `TensorBoard` callback?  
A) It controls how often logs are written (e.g., every batch or every epoch)  
B) It sets the frequency of model checkpoint saving  
C) It determines how often the training stops for evaluation  
D) It controls the frequency of early stopping checks  

#### 20. Which of the following statements about callback usage during prediction are correct?  
A) Callbacks can be passed to `model.predict()` to monitor prediction progress  
B) `on_predict_batch_begin` and `on_predict_batch_end` methods are called during prediction  
C) Callbacks can modify the predicted output values during prediction  
D) Callbacks are not supported during prediction



<br>

## Answers

#### 1. Which of the following methods are called at the **start and end of each epoch** during training in a Keras callback?  
A) ✓ Called at the start of each epoch  
B) ✓ Called at the end of each epoch  
C) ✗ Called before each batch, not epoch  
D) ✗ Called after each batch, not epoch  

**Correct:** A, B


#### 2. When creating a custom callback by subclassing `tf.keras.callbacks.Callback`, which method(s) would you override to execute code **before and after processing each training batch**?  
A) ✓ Called before processing each training batch  
B) ✓ Called after processing each training batch  
C) ✗ Called at epoch start, not batch  
D) ✗ Related to prediction batches, not training  

**Correct:** A, B


#### 3. Which of the following are valid ways to use callbacks in Keras model methods?  
A) ✓ `fit` accepts callbacks  
B) ✓ `evaluate` accepts callbacks  
C) ✓ `predict` accepts callbacks  
D) ✗ `compile` does not accept callbacks  

**Correct:** A, B, C


#### 4. The `ModelCheckpoint` callback can be configured to:  
A) ✓ Can save only weights  
B) ✓ Can save only when monitored metric improves  
C) ✗ Does not stop training, only saves models  
D) ✗ Default save frequency is per epoch, not per batch  

**Correct:** A, B


#### 5. What is the purpose of the `EarlyStopping` callback?  
A) ✗ It does not save models, only stops training  
B) ✓ Stops training when monitored metric stops improving  
C) ✗ Logging is done by CSVLogger, not EarlyStopping  
D) ✓ Helps prevent overfitting by stopping early  

**Correct:** B, D


#### 6. Which parameters of `EarlyStopping` control how sensitive it is to improvements in the monitored metric?  
A) ✓ `patience` controls how many epochs to wait  
B) ✓ `min_delta` sets minimum improvement threshold  
C) ✓ `baseline` sets minimum acceptable metric value  
D) ✗ `save_best_only` is a ModelCheckpoint parameter  

**Correct:** A, B, C


#### 7. When using the `TensorBoard` callback, which of the following are true?  
A) ✓ Can visualize model graph  
B) ✓ Tracks metrics like loss and accuracy  
C) ✗ Does not save model checkpoints  
D) ✓ Requires specifying a log directory  

**Correct:** A, B, D


#### 8. Which of the following statements about the `logs` argument passed to callback methods is true?  
A) ✗ Batch number is passed as a separate argument, not in logs  
B) ✓ Contains metrics and loss values for current step  
C) ✗ Logs is not always empty; it contains useful info  
D) ✓ Validation metrics are available in `on_epoch_end` logs  

**Correct:** B, D


#### 9. Which callback method(s) would you override to perform an action **right before training starts** and **right after training ends**?  
A) ✓ `on_train_begin` and `on_train_end` are for training start/end  
B) ✗ Called at epoch level, not training start/end  
C) ✗ Called per batch, not training start/end  
D) ✗ Related to evaluation, not training  

**Correct:** A


#### 10. What happens if you set `restore_best_weights=True` in the `EarlyStopping` callback?  
A) ✓ Model weights are restored to best epoch after stopping  
B) ✗ Does not save weights to disk automatically  
C) ✗ Training stops based on patience, not indefinite  
D) ✗ `patience` is still respected  

**Correct:** A


#### 11. Which of the following are true about saving models with `ModelCheckpoint`?  
A) ✓ Supports both H5 and SavedModel formats  
B) ✓ Filename can include epoch and metric values  
C) ✗ Can save weights only if specified  
D) ✓ Can save checkpoints at specified frequency  

**Correct:** A, B, D


#### 12. In a custom callback, what is the effect of setting `self.model.stop_training = True` inside a callback method?  
A) ✓ Immediately stops training after current batch or epoch  
B) ✗ Does not pause training, it stops it  
C) ✗ Does not reset weights  
D) ✗ Does not trigger saving checkpoint automatically  

**Correct:** A


#### 13. Which of the following callback methods are called during **evaluation** (testing) but not during training?  
A) ✓ Called at evaluation start  
B) ✗ Training batch method, not evaluation  
C) ✓ Called after each evaluation batch  
D) ✗ Related to prediction, not evaluation  

**Correct:** A, C


#### 14. What is the main difference between `on_train_batch_end` and `on_epoch_end` callback methods?  
A) ✓ `on_train_batch_end` called after every batch, `on_epoch_end` after every epoch  
B) ✗ `on_train_batch_end` is called every batch, not once per epoch  
C) ✗ `on_epoch_end` is called after epoch, not before training  
D) ✗ `on_train_batch_end` is called during training, not evaluation only  

**Correct:** A


#### 15. Which of the following are valid reasons to create a **custom callback**?  
A) ✓ To log info not covered by built-in callbacks  
B) ✓ To stop training based on custom conditions  
C) ✓ To visualize intermediate predictions during training  
D) ✗ Hyperparameter tuning is usually done outside callbacks  

**Correct:** A, B, C


#### 16. Consider a callback that monitors the ratio of validation loss to training loss and stops training if the ratio exceeds a threshold. Which callback method is best suited to implement this logic?  
A) ✓ `on_epoch_end` is best to access epoch metrics  
B) ✗ Batch end does not have full epoch metrics  
C) ✗ Called only once at training start  
D) ✗ Called after prediction, not training  

**Correct:** A


#### 17. When using multiple callbacks in `model.fit()`, which of the following statements are true?  
A) ✓ All callbacks receive event notifications independently  
B) ✗ Callbacks generally do not interfere if implemented correctly  
C) ✓ You can combine multiple callbacks like EarlyStopping and ModelCheckpoint  
D) ✗ Multiple callbacks can be active simultaneously  

**Correct:** A, C, D


#### 18. Which of the following are true about the `CSVLogger` callback?  
A) ✓ Saves metrics to CSV after each epoch  
B) ✓ Logs both training and validation metrics if available  
C) ✗ Does not stop training on metric changes  
D) ✗ Saves automatically, no manual save needed  

**Correct:** A, B


#### 19. What is the role of the `update_freq` parameter in the `TensorBoard` callback?  
A) ✓ Controls how often logs are written (e.g., per batch or epoch)  
B) ✗ Does not control checkpoint saving frequency  
C) ✗ Does not control evaluation frequency  
D) ✗ Does not control early stopping checks  

**Correct:** A


#### 20. Which of the following statements about callback usage during prediction are correct?  
A) ✓ Callbacks can be passed to `model.predict()`  
B) ✓ `on_predict_batch_begin` and `on_predict_batch_end` are called during prediction  
C) ✗ Callbacks cannot modify predicted outputs  
D) ✗ Callbacks are supported during prediction  

**Correct:** A, B, D